{"ast":null,"code":"import React,{useState,useEffect}from'react';import{academicsService}from'../../api/academicsService';import ReportCard from'../ReportCard';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faFilter,faCheckCircle}from'@fortawesome/free-solid-svg-icons';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const SearchableStudentSelect=_ref=>{let{students,selectedStudent,onStudentSelect,disabled}=_ref;const[searchTerm,setSearchTerm]=useState('');const[isOpen,setIsOpen]=useState(false);const[filteredStudents,setFilteredStudents]=useState(students);useEffect(()=>{const filtered=students.filter(student=>student.toLowerCase().includes(searchTerm.toLowerCase()));setFilteredStudents(filtered);},[students,searchTerm]);return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:selectedStudent||searchTerm,onChange:e=>{setSearchTerm(e.target.value);if(!isOpen)setIsOpen(true);},onFocus:()=>setIsOpen(true),onBlur:()=>setTimeout(()=>setIsOpen(false),200),disabled:disabled,placeholder:disabled?'No students available':'Search students by name...',className:\"shadow appearance-none border rounded w-full py-2 px-3 pr-10 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsOpen(!isOpen),disabled:disabled,className:\"absolute inset-y-0 right-0 flex items-center pr-3 disabled:cursor-not-allowed\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faFilter,className:\"text-gray-400\"})})]}),isOpen&&!disabled&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none\",children:filteredStudents.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-2 text-gray-500\",children:\"No students found\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{onClick:()=>{onStudentSelect(null);setSearchTerm('');setIsOpen(false);},className:\"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100\",children:/*#__PURE__*/_jsx(\"span\",{className:\"font-normal block truncate text-gray-500\",children:\"Clear selection\"})}),filteredStudents.map(studentName=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{onStudentSelect(studentName);setSearchTerm('');setIsOpen(false);},className:\"cursor-pointer select-none relative py-2 pl-3 pr-9 \".concat(selectedStudent===studentName?'bg-indigo-100 text-indigo-900':'hover:bg-gray-100'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-normal block truncate \".concat(selectedStudent===studentName?'font-semibold':''),children:studentName}),selectedStudent===studentName&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute inset-y-0 right-0 flex items-center pr-4\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheckCircle,className:\"text-indigo-600\"})})]},studentName))]})})]});};const ResultManagement=()=>{const[results,setResults]=useState([]);const[filteredResults,setFilteredResults]=useState([]);const[departments,setDepartments]=useState([]);const[courses,setCourses]=useState([]);const[selectedDepartment,setSelectedDepartment]=useState(null);const[selectedCourse,setSelectedCourse]=useState(null);const[loading,setLoading]=useState(false);const[searchTerm,setSearchTerm]=useState('');const[selectedGrade,setSelectedGrade]=useState('');const[selectedExamType,setSelectedExamType]=useState('');const[showFilters,setShowFilters]=useState(false);const[selectedResults,setSelectedResults]=useState([]);const[showReportCard,setShowReportCard]=useState(false);const[selectedStudentForReport,setSelectedStudentForReport]=useState(null);const[reportCardData,setReportCardData]=useState(null);const[loadingReport,setLoadingReport]=useState(false);// Helper function to safely get department name\nconst getDepartmentName=departmentData=>{if(!departmentData)return'N/A';// If it's an object with a name property, extract the name\nif(typeof departmentData==='object'&&departmentData!==null&&'name'in departmentData){return departmentData.name||'N/A';}// If it's a string, return as is\nif(typeof departmentData==='string'){return departmentData||'N/A';}// Fallback - if it's an object but doesn't have name, return N/A\nif(typeof departmentData==='object'&&departmentData!==null){return'N/A';}// Fallback\nreturn'N/A';};// Helper function to safely get course name\nconst getCourseName=courseData=>{if(!courseData)return'N/A';// If it's an object with a name property, extract the name\nif(typeof courseData==='object'&&courseData!==null&&'name'in courseData){return courseData.name||'N/A';}// If it's an object with course_name property, extract the course_name\nif(typeof courseData==='object'&&courseData!==null&&'course_name'in courseData){return courseData.course_name||'N/A';}// If it's a string, return as is\nif(typeof courseData==='string'){return courseData||'N/A';}// Fallback - if it's an object but doesn't have name or course_name, return N/A\nif(typeof courseData==='object'&&courseData!==null){return'N/A';}// Fallback\nreturn'N/A';};useEffect(()=>{// Fetch departments\nconst fetchDepartments=async()=>{try{const response=await academicsService.getDepartments();setDepartments(response.data);}catch(error){console.error('Failed to fetch departments:',error);}};fetchDepartments();},[]);useEffect(()=>{// Fetch courses when department changes\nconst fetchCourses=async()=>{if(selectedDepartment){try{const response=await academicsService.getCoursesByDepartment(selectedDepartment);setCourses(response.data);}catch(error){console.error('Failed to fetch courses:',error);}}else{setCourses([]);}};fetchCourses();},[selectedDepartment]);useEffect(()=>{// Fetch results when department or course changes\nconst fetchResults=async()=>{if(selectedDepartment&&selectedCourse){setLoading(true);try{const response=await academicsService.getResultsByDepartmentCourse(selectedDepartment,selectedCourse);setResults(response.data);setFilteredResults(response.data);}catch(error){console.error('Failed to fetch results:',error);}finally{setLoading(false);}}else{setResults([]);setFilteredResults([]);}};fetchResults();},[selectedDepartment,selectedCourse]);// Apply filters when search term or filters change\nuseEffect(()=>{let filtered=results;// Search filter\nif(searchTerm){filtered=filtered.filter(result=>result.student_name.toLowerCase().includes(searchTerm.toLowerCase())||result.subject.toLowerCase().includes(searchTerm.toLowerCase()));}// Grade filter\nif(selectedGrade){filtered=filtered.filter(result=>result.grade===selectedGrade);}// Exam type filter\nif(selectedExamType){filtered=filtered.filter(result=>result.exam_type===selectedExamType);}setFilteredResults(filtered);},[results,searchTerm,selectedGrade,selectedExamType]);// Calculate statistics\nconst getStatistics=()=>{const total=filteredResults.length;const gradeCounts=filteredResults.reduce((acc,result)=>{acc[result.grade]=(acc[result.grade]||0)+1;return acc;},{});const avgPercentage=total>0?filteredResults.reduce((sum,result)=>sum+result.percentage,0)/total:0;return{total,gradeCounts,avgPercentage};};const statistics=getStatistics();// Export functions\nconst exportToCSV=()=>{const headers=['Student Name','Subject','Exam Type','Marks','Grade','Percentage','Exam Date','Semester','Department'];const csvContent=[headers.join(','),...filteredResults.map(result=>[result.student_name,result.subject,result.exam_type,result.marks,result.grade,result.percentage.toFixed(1),result.exam_date,result.semester,getDepartmentName(result.department)].join(','))].join('\\n');const blob=new Blob([csvContent],{type:'text/csv'});const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='results.csv';a.click();window.URL.revokeObjectURL(url);};const exportStudentReportToCSV=()=>{// Group results by student_id to get unique students\nconst studentMap=new Map();filteredResults.forEach(result=>{if(!studentMap.has(result.student_id)){studentMap.set(result.student_id,{student_id:result.student_id,student_name:result.student_name,semester:result.semester,department:getDepartmentName(result.department)});}});const uniqueStudents=Array.from(studentMap.values());const headers=['Student ID','Student Name','Semester','Department'];const csvContent=[headers.join(','),...uniqueStudents.map(student=>[student.student_id,student.student_name,student.semester,student.department].join(','))].join('\\n');const blob=new Blob([csvContent],{type:'text/csv'});const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='student_report.csv';a.click();window.URL.revokeObjectURL(url);};// Bulk operations\nconst handleSelectAll=checked=>{if(checked){setSelectedResults(filteredResults.map(r=>r.id));}else{setSelectedResults([]);}};const handleSelectResult=(id,checked)=>{if(checked){setSelectedResults([...selectedResults,id]);}else{setSelectedResults(selectedResults.filter(r=>r!==id));}};const handleBulkDelete=async()=>{if(!window.confirm(\"Delete \".concat(selectedResults.length,\" selected results?\")))return;try{setLoading(true);await Promise.all(selectedResults.map(id=>academicsService.deleteResult(id)));// Refresh results\nif(selectedDepartment&&selectedCourse){const response=await academicsService.getResultsByDepartmentCourse(selectedDepartment,selectedCourse);setResults(response.data);setFilteredResults(response.data);}setSelectedResults([]);}catch(error){console.error('Failed to delete results:',error);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800\",children:\"Advanced Result Management\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowReportCard(true),disabled:filteredResults.length===0,className:\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Generate Report Card\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportStudentReportToCSV,disabled:filteredResults.length===0,className:\"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 disabled:bg-gray-400 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Generate Student Report\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportToCSV,disabled:filteredResults.length===0,className:\"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:bg-gray-400 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Export CSV\"})]}),selectedResults.length>0&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleBulkDelete,className:\"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"})}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Delete Selected (\",selectedResults.length,\")\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg shadow border\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-blue-100 rounded-lg\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-blue-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Total Results\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:statistics.total})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg shadow border\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-green-100 rounded-lg\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-green-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Avg Percentage\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:[statistics.avgPercentage.toFixed(1),\"%\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg shadow border\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-yellow-100 rounded-lg\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-yellow-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"F Grades\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-red-600\",children:statistics.gradeCounts['F']||0})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg shadow border\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-purple-100 rounded-lg\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-purple-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"A+ Grades\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-green-600\",children:statistics.gradeCounts['A+']||0})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-4 rounded-lg shadow border\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Filters & Search\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFilters(!showFilters),className:\"text-blue-600 hover:text-blue-800 flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z\"})}),/*#__PURE__*/_jsxs(\"span\",{children:[showFilters?'Hide':'Show',\" Filters\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"Department\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedDepartment!==null&&selectedDepartment!==void 0?selectedDepartment:'',onChange:e=>setSelectedDepartment(e.target.value?Number(e.target.value):null),className:\"w-full border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Department\"}),departments.map(dept=>/*#__PURE__*/_jsx(\"option\",{value:dept.id,children:dept.name},dept.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"Course\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedCourse!==null&&selectedCourse!==void 0?selectedCourse:'',onChange:e=>setSelectedCourse(e.target.value?Number(e.target.value):null),className:\"w-full border p-2 rounded\",disabled:!selectedDepartment,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Course\"}),courses.map(course=>/*#__PURE__*/_jsx(\"option\",{value:course.id,children:course.name},course.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"Search\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search by student or subject...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full border p-2 rounded\"})]}),showFilters&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"Grade\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedGrade,onChange:e=>setSelectedGrade(e.target.value),className:\"w-full border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Grades\"}),/*#__PURE__*/_jsx(\"option\",{value:\"A+\",children:\"A+\"}),/*#__PURE__*/_jsx(\"option\",{value:\"A\",children:\"A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"A-\",children:\"A-\"}),/*#__PURE__*/_jsx(\"option\",{value:\"B+\",children:\"B+\"}),/*#__PURE__*/_jsx(\"option\",{value:\"B\",children:\"B\"}),/*#__PURE__*/_jsx(\"option\",{value:\"B-\",children:\"B-\"}),/*#__PURE__*/_jsx(\"option\",{value:\"C+\",children:\"C+\"}),/*#__PURE__*/_jsx(\"option\",{value:\"C\",children:\"C\"}),/*#__PURE__*/_jsx(\"option\",{value:\"C-\",children:\"C-\"}),/*#__PURE__*/_jsx(\"option\",{value:\"D+\",children:\"D+\"}),/*#__PURE__*/_jsx(\"option\",{value:\"D\",children:\"D\"}),/*#__PURE__*/_jsx(\"option\",{value:\"F\",children:\"F\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"Exam Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedExamType,onChange:e=>setSelectedExamType(e.target.value),className:\"w-full border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Types\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Quiz 1\",children:\"Quiz 1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Quiz 2\",children:\"Quiz 2\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Assignment 1\",children:\"Assignment 1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Assignment 2\",children:\"Assignment 2\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Mid Term\",children:\"Mid Term\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Final Exam\",children:\"Final Exam\"})]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow border overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:[\"Results (\",filteredResults.length,\")\"]}),filteredResults.length>0&&/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedResults.length===filteredResults.length&&filteredResults.length>0,onChange:e=>handleSelectAll(e.target.checked),className:\"rounded\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700\",children:\"Select All\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedResults.length===filteredResults.length&&filteredResults.length>0,onChange:e=>handleSelectAll(e.target.checked),className:\"rounded\"})}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Student\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Subject\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Exam Type\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Marks\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Grade\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Percentage\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:loading?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:9,className:\"px-4 py-8 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 text-blue-600 mr-2\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Loading results...\"]})})}):filteredResults.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:9,className:\"px-4 py-8 text-center text-gray-500\",children:selectedDepartment&&selectedCourse?'No results found for the selected filters.':'Please select a department and course to view results.'})}):filteredResults.map(result=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedResults.includes(result.id),onChange:e=>handleSelectResult(result.id,e.target.checked),className:\"rounded\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-900\",children:result.student_name})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-900\",children:result.subject})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800\",children:result.exam_type})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:result.marks}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex px-2 py-1 text-xs font-semibold rounded-full \".concat(result.grade==='F'?'bg-red-100 text-red-800':result.grade.startsWith('A')?'bg-green-100 text-green-800':result.grade.startsWith('B')?'bg-blue-100 text-blue-800':'bg-yellow-100 text-yellow-800'),children:result.grade})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:[result.percentage.toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-500\",children:new Date(result.exam_date).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm font-medium\",children:/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{if(window.confirm('Delete this result?')){try{await academicsService.deleteResult(result.result_id);// Refresh the data\nif(selectedDepartment&&selectedCourse){const response=await academicsService.getResultsByDepartmentCourse(selectedDepartment,selectedCourse);setResults(response.data);}}catch(error){console.error('Failed to delete result:',error);}}},className:\"text-red-600 hover:text-red-900 mr-3\",children:\"Delete\"})})]},result.id))})]})})]}),showReportCard&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Generate Student Report Card\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowReportCard(false);setSelectedStudentForReport(null);setReportCardData(null);},className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:!selectedStudentForReport?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Select a student to generate their report card:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(SearchableStudentSelect,{students:Array.from(new Set(filteredResults.map(r=>r.student_name))),selectedStudent:null,onStudentSelect:studentName=>{if(studentName){const studentResult=filteredResults.find(r=>r.student_name===studentName);setSelectedStudentForReport(studentResult);}},disabled:filteredResults.length===0})}),filteredResults.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 text-center py-4\",children:\"No students available. Please select a department and course first.\"})]}):/*#__PURE__*/_jsx(\"div\",{children:loadingReport?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-8 w-8 text-blue-600 mx-auto mb-4\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Generating report card...\"})]}):reportCardData?/*#__PURE__*/_jsx(ReportCard,{student:reportCardData.student,assignedCourses:reportCardData.assignedCourses,results:reportCardData.results,onClose:()=>{setShowReportCard(false);setSelectedStudentForReport(null);setReportCardData(null);}}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-4\",children:[\"Selected student: \",/*#__PURE__*/_jsx(\"strong\",{children:selectedStudentForReport.student_name})]}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{setLoadingReport(true);try{// Find student ID from results - this might need adjustment based on actual data structure\nconst studentResults=filteredResults.filter(r=>r.student_name===selectedStudentForReport.student_name);if(studentResults.length>0){// Use student_id as string since it's the primary key\nconst studentId=studentResults[0].student_id;const response=await academicsService.getStudentResults(studentId);setReportCardData(response.data);}}catch(error){console.error('Failed to fetch student report data:',error);alert('Failed to generate report card. Please try again.');}finally{setLoadingReport(false);}},className:\"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700\",children:\"Generate Report Card\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedStudentForReport(null),className:\"ml-4 text-gray-600 hover:text-gray-800\",children:\"Back to Student List\"})]})})})]})})]});};export default ResultManagement;","map":{"version":3,"names":["React","useState","useEffect","academicsService","ReportCard","FontAwesomeIcon","faFilter","faCheckCircle","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SearchableStudentSelect","_ref","students","selectedStudent","onStudentSelect","disabled","searchTerm","setSearchTerm","isOpen","setIsOpen","filteredStudents","setFilteredStudents","filtered","filter","student","toLowerCase","includes","className","children","type","value","onChange","e","target","onFocus","onBlur","setTimeout","placeholder","onClick","icon","length","map","studentName","concat","ResultManagement","results","setResults","filteredResults","setFilteredResults","departments","setDepartments","courses","setCourses","selectedDepartment","setSelectedDepartment","selectedCourse","setSelectedCourse","loading","setLoading","selectedGrade","setSelectedGrade","selectedExamType","setSelectedExamType","showFilters","setShowFilters","selectedResults","setSelectedResults","showReportCard","setShowReportCard","selectedStudentForReport","setSelectedStudentForReport","reportCardData","setReportCardData","loadingReport","setLoadingReport","getDepartmentName","departmentData","name","getCourseName","courseData","course_name","fetchDepartments","response","getDepartments","data","error","console","fetchCourses","getCoursesByDepartment","fetchResults","getResultsByDepartmentCourse","result","student_name","subject","grade","exam_type","getStatistics","total","gradeCounts","reduce","acc","avgPercentage","sum","percentage","statistics","exportToCSV","headers","csvContent","join","marks","toFixed","exam_date","semester","department","blob","Blob","url","window","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","exportStudentReportToCSV","studentMap","Map","forEach","has","student_id","set","uniqueStudents","Array","from","values","handleSelectAll","checked","r","id","handleSelectResult","handleBulkDelete","confirm","Promise","all","deleteResult","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","Number","dept","course","colSpan","cx","cy","startsWith","Date","toLocaleDateString","result_id","Set","studentResult","find","assignedCourses","onClose","studentResults","studentId","getStudentResults","alert"],"sources":["c:/UMI/Frontend/src/components/pages/ResultManagement.tsx"],"sourcesContent":["import React, { useState, useEffect, ReactElement } from 'react';\r\nimport { academicsService } from '../../api/academicsService';\r\nimport ReportCard from '../ReportCard';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faFilter, faCheckCircle } from '@fortawesome/free-solid-svg-icons';\r\n\r\ninterface Result {\r\n  id: number;\r\n  student_id: string;\r\n  result_id: number;\r\n  student_name: string;\r\n  subject: string;\r\n  grade: string;\r\n  marks: string;\r\n  percentage: number;\r\n  exam_type: string;\r\n  exam_date: string;\r\n  semester: string;\r\n  department: string;\r\n  course: any;\r\n}\r\n\r\ninterface SearchableStudentSelectProps {\r\n  students: string[];\r\n  selectedStudent: string | null;\r\n  onStudentSelect: (studentName: string | null) => void;\r\n  disabled: boolean;\r\n}\r\n\r\nconst SearchableStudentSelect: React.FC<SearchableStudentSelectProps> = ({\r\n  students,\r\n  selectedStudent,\r\n  onStudentSelect,\r\n  disabled\r\n}) => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [filteredStudents, setFilteredStudents] = useState<string[]>(students);\r\n\r\n  useEffect(() => {\r\n    const filtered = students.filter(student =>\r\n      student.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n    setFilteredStudents(filtered);\r\n  }, [students, searchTerm]);\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <div className=\"relative\">\r\n        <input\r\n          type=\"text\"\r\n          value={selectedStudent || searchTerm}\r\n          onChange={(e) => {\r\n            setSearchTerm(e.target.value);\r\n            if (!isOpen) setIsOpen(true);\r\n          }}\r\n          onFocus={() => setIsOpen(true)}\r\n          onBlur={() => setTimeout(() => setIsOpen(false), 200)}\r\n          disabled={disabled}\r\n          placeholder={disabled ? 'No students available' : 'Search students by name...'}\r\n          className=\"shadow appearance-none border rounded w-full py-2 px-3 pr-10 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\"\r\n        />\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setIsOpen(!isOpen)}\r\n          disabled={disabled}\r\n          className=\"absolute inset-y-0 right-0 flex items-center pr-3 disabled:cursor-not-allowed\"\r\n        >\r\n          <FontAwesomeIcon icon={faFilter} className=\"text-gray-400\" />\r\n        </button>\r\n      </div>\r\n\r\n      {isOpen && !disabled && (\r\n        <div className=\"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none\">\r\n          {filteredStudents.length === 0 ? (\r\n            <div className=\"px-3 py-2 text-gray-500\">No students found</div>\r\n          ) : (\r\n            <>\r\n              <div\r\n                onClick={() => {\r\n                  onStudentSelect(null);\r\n                  setSearchTerm('');\r\n                  setIsOpen(false);\r\n                }}\r\n                className=\"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100\"\r\n              >\r\n                <span className=\"font-normal block truncate text-gray-500\">Clear selection</span>\r\n              </div>\r\n              {filteredStudents.map((studentName) => (\r\n                <div\r\n                  key={studentName}\r\n                  onClick={() => {\r\n                    onStudentSelect(studentName);\r\n                    setSearchTerm('');\r\n                    setIsOpen(false);\r\n                  }}\r\n                  className={`cursor-pointer select-none relative py-2 pl-3 pr-9 ${\r\n                    selectedStudent === studentName ? 'bg-indigo-100 text-indigo-900' : 'hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  <span className={`font-normal block truncate ${selectedStudent === studentName ? 'font-semibold' : ''}`}>\r\n                    {studentName}\r\n                  </span>\r\n                  {selectedStudent === studentName && (\r\n                    <span className=\"absolute inset-y-0 right-0 flex items-center pr-4\">\r\n                      <FontAwesomeIcon icon={faCheckCircle} className=\"text-indigo-600\" />\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\nconst ResultManagement: React.FC = () => {\r\n  const [results, setResults] = useState<Result[]>([]);\r\n  const [filteredResults, setFilteredResults] = useState<Result[]>([]);\r\n  const [departments, setDepartments] = useState<any[]>([]);\r\n  const [courses, setCourses] = useState<any[]>([]);\r\n  const [selectedDepartment, setSelectedDepartment] = useState<number | null>(null);\r\n  const [selectedCourse, setSelectedCourse] = useState<number | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedGrade, setSelectedGrade] = useState('');\r\n  const [selectedExamType, setSelectedExamType] = useState('');\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [selectedResults, setSelectedResults] = useState<number[]>([]);\r\n  const [showReportCard, setShowReportCard] = useState(false);\r\n  const [selectedStudentForReport, setSelectedStudentForReport] = useState<any>(null);\r\n  const [reportCardData, setReportCardData] = useState<any>(null);\r\n  const [loadingReport, setLoadingReport] = useState(false);\r\n\r\n  // Helper function to safely get department name\r\n  const getDepartmentName = (departmentData: any): string => {\r\n    if (!departmentData) return 'N/A';\r\n\r\n    // If it's an object with a name property, extract the name\r\n    if (typeof departmentData === 'object' && departmentData !== null && 'name' in departmentData) {\r\n      return departmentData.name || 'N/A';\r\n    }\r\n\r\n    // If it's a string, return as is\r\n    if (typeof departmentData === 'string') {\r\n      return departmentData || 'N/A';\r\n    }\r\n\r\n    // Fallback - if it's an object but doesn't have name, return N/A\r\n    if (typeof departmentData === 'object' && departmentData !== null) {\r\n      return 'N/A';\r\n    }\r\n\r\n    // Fallback\r\n    return 'N/A';\r\n  };\r\n\r\n  // Helper function to safely get course name\r\n  const getCourseName = (courseData: any): string => {\r\n    if (!courseData) return 'N/A';\r\n\r\n    // If it's an object with a name property, extract the name\r\n    if (typeof courseData === 'object' && courseData !== null && 'name' in courseData) {\r\n      return courseData.name || 'N/A';\r\n    }\r\n\r\n    // If it's an object with course_name property, extract the course_name\r\n    if (typeof courseData === 'object' && courseData !== null && 'course_name' in courseData) {\r\n      return courseData.course_name || 'N/A';\r\n    }\r\n\r\n    // If it's a string, return as is\r\n    if (typeof courseData === 'string') {\r\n      return courseData || 'N/A';\r\n    }\r\n\r\n    // Fallback - if it's an object but doesn't have name or course_name, return N/A\r\n    if (typeof courseData === 'object' && courseData !== null) {\r\n      return 'N/A';\r\n    }\r\n\r\n    // Fallback\r\n    return 'N/A';\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Fetch departments\r\n    const fetchDepartments = async () => {\r\n      try {\r\n        const response = await academicsService.getDepartments();\r\n        setDepartments(response.data);\r\n      } catch (error) {\r\n        console.error('Failed to fetch departments:', error);\r\n      }\r\n    };\r\n\r\n    fetchDepartments();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Fetch courses when department changes\r\n    const fetchCourses = async () => {\r\n      if (selectedDepartment) {\r\n        try {\r\n          const response = await academicsService.getCoursesByDepartment(selectedDepartment);\r\n          setCourses(response.data);\r\n        } catch (error) {\r\n          console.error('Failed to fetch courses:', error);\r\n        }\r\n      } else {\r\n        setCourses([]);\r\n      }\r\n    };\r\n\r\n    fetchCourses();\r\n  }, [selectedDepartment]);\r\n\r\n  useEffect(() => {\r\n    // Fetch results when department or course changes\r\n    const fetchResults = async () => {\r\n      if (selectedDepartment && selectedCourse) {\r\n        setLoading(true);\r\n        try {\r\n          const response = await academicsService.getResultsByDepartmentCourse(selectedDepartment, selectedCourse);\r\n          setResults(response.data);\r\n          setFilteredResults(response.data);\r\n        } catch (error) {\r\n          console.error('Failed to fetch results:', error);\r\n        } finally {\r\n          setLoading(false);\r\n        }\r\n      } else {\r\n        setResults([]);\r\n        setFilteredResults([]);\r\n      }\r\n    };\r\n\r\n    fetchResults();\r\n  }, [selectedDepartment, selectedCourse]);\r\n\r\n  // Apply filters when search term or filters change\r\n  useEffect(() => {\r\n    let filtered = results;\r\n\r\n    // Search filter\r\n    if (searchTerm) {\r\n      filtered = filtered.filter(result =>\r\n        result.student_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        result.subject.toLowerCase().includes(searchTerm.toLowerCase())\r\n      );\r\n    }\r\n\r\n    // Grade filter\r\n    if (selectedGrade) {\r\n      filtered = filtered.filter(result => result.grade === selectedGrade);\r\n    }\r\n\r\n    // Exam type filter\r\n    if (selectedExamType) {\r\n      filtered = filtered.filter(result => result.exam_type === selectedExamType);\r\n    }\r\n\r\n    setFilteredResults(filtered);\r\n  }, [results, searchTerm, selectedGrade, selectedExamType]);\r\n\r\n  // Calculate statistics\r\n  const getStatistics = () => {\r\n    const total = filteredResults.length;\r\n    const gradeCounts = filteredResults.reduce((acc, result) => {\r\n      acc[result.grade] = (acc[result.grade] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<string, number>);\r\n\r\n    const avgPercentage = total > 0\r\n      ? filteredResults.reduce((sum, result) => sum + result.percentage, 0) / total\r\n      : 0;\r\n\r\n    return { total, gradeCounts, avgPercentage };\r\n  };\r\n\r\n  const statistics = getStatistics();\r\n\r\n  // Export functions\r\n  const exportToCSV = () => {\r\n    const headers = ['Student Name', 'Subject', 'Exam Type', 'Marks', 'Grade', 'Percentage', 'Exam Date', 'Semester', 'Department'];\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...filteredResults.map(result => [\r\n        result.student_name,\r\n        result.subject,\r\n        result.exam_type,\r\n        result.marks,\r\n        result.grade,\r\n        result.percentage.toFixed(1),\r\n        result.exam_date,\r\n        result.semester,\r\n        getDepartmentName(result.department)\r\n      ].join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'results.csv';\r\n    a.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const exportStudentReportToCSV = () => {\r\n    // Group results by student_id to get unique students\r\n    const studentMap = new Map<string, any>();\r\n\r\n    filteredResults.forEach(result => {\r\n      if (!studentMap.has(result.student_id)) {\r\n        studentMap.set(result.student_id, {\r\n          student_id: result.student_id,\r\n          student_name: result.student_name,\r\n          semester: result.semester,\r\n          department: getDepartmentName(result.department)\r\n        });\r\n      }\r\n    });\r\n\r\n    const uniqueStudents = Array.from(studentMap.values());\r\n\r\n    const headers = ['Student ID', 'Student Name', 'Semester', 'Department'];\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...uniqueStudents.map(student => [\r\n        student.student_id,\r\n        student.student_name,\r\n        student.semester,\r\n        student.department\r\n      ].join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'student_report.csv';\r\n    a.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Bulk operations\r\n  const handleSelectAll = (checked: boolean) => {\r\n    if (checked) {\r\n      setSelectedResults(filteredResults.map(r => r.id));\r\n    } else {\r\n      setSelectedResults([]);\r\n    }\r\n  };\r\n\r\n  const handleSelectResult = (id: number, checked: boolean) => {\r\n    if (checked) {\r\n      setSelectedResults([...selectedResults, id]);\r\n    } else {\r\n      setSelectedResults(selectedResults.filter(r => r !== id));\r\n    }\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (!window.confirm(`Delete ${selectedResults.length} selected results?`)) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      await Promise.all(selectedResults.map(id => academicsService.deleteResult(id)));\r\n      // Refresh results\r\n      if (selectedDepartment && selectedCourse) {\r\n        const response = await academicsService.getResultsByDepartmentCourse(selectedDepartment, selectedCourse);\r\n        setResults(response.data);\r\n        setFilteredResults(response.data);\r\n      }\r\n      setSelectedResults([]);\r\n    } catch (error) {\r\n      console.error('Failed to delete results:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800\">Advanced Result Management</h2>\r\n        <div className=\"flex space-x-2\">\r\n          <button\r\n            onClick={() => setShowReportCard(true)}\r\n            disabled={filteredResults.length === 0}\r\n            className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 flex items-center space-x-2\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n            </svg>\r\n            <span>Generate Report Card</span>\r\n          </button>\r\n          <button\r\n            onClick={exportStudentReportToCSV}\r\n            disabled={filteredResults.length === 0}\r\n            className=\"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 disabled:bg-gray-400 flex items-center space-x-2\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n            </svg>\r\n            <span>Generate Student Report</span>\r\n          </button>\r\n          <button\r\n            onClick={exportToCSV}\r\n            disabled={filteredResults.length === 0}\r\n            className=\"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:bg-gray-400 flex items-center space-x-2\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n            </svg>\r\n            <span>Export CSV</span>\r\n          </button>\r\n          {selectedResults.length > 0 && (\r\n            <button\r\n              onClick={handleBulkDelete}\r\n              className=\"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 flex items-center space-x-2\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n              </svg>\r\n              <span>Delete Selected ({selectedResults.length})</span>\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <div className=\"bg-white p-4 rounded-lg shadow border\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-3 bg-blue-100 rounded-lg\">\r\n              <svg className=\"w-6 h-6 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n              </svg>\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <p className=\"text-sm font-medium text-gray-600\">Total Results</p>\r\n              <p className=\"text-2xl font-bold text-gray-900\">{statistics.total}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-white p-4 rounded-lg shadow border\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-3 bg-green-100 rounded-lg\">\r\n              <svg className=\"w-6 h-6 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n              </svg>\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <p className=\"text-sm font-medium text-gray-600\">Avg Percentage</p>\r\n              <p className=\"text-2xl font-bold text-gray-900\">{statistics.avgPercentage.toFixed(1)}%</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-white p-4 rounded-lg shadow border\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-3 bg-yellow-100 rounded-lg\">\r\n              <svg className=\"w-6 h-6 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n              </svg>\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <p className=\"text-sm font-medium text-gray-600\">F Grades</p>\r\n              <p className=\"text-2xl font-bold text-red-600\">{statistics.gradeCounts['F'] || 0}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-white p-4 rounded-lg shadow border\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"p-3 bg-purple-100 rounded-lg\">\r\n              <svg className=\"w-6 h-6 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\" />\r\n              </svg>\r\n            </div>\r\n            <div className=\"ml-4\">\r\n              <p className=\"text-sm font-medium text-gray-600\">A+ Grades</p>\r\n              <p className=\"text-2xl font-bold text-green-600\">{statistics.gradeCounts['A+'] || 0}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters and Search */}\r\n      <div className=\"bg-white p-4 rounded-lg shadow border\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h3 className=\"text-lg font-semibold\">Filters & Search</h3>\r\n          <button\r\n            onClick={() => setShowFilters(!showFilters)}\r\n            className=\"text-blue-600 hover:text-blue-800 flex items-center space-x-1\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z\" />\r\n            </svg>\r\n            <span>{showFilters ? 'Hide' : 'Show'} Filters</span>\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-1\">Department</label>\r\n            <select\r\n              value={selectedDepartment ?? ''}\r\n              onChange={(e) => setSelectedDepartment(e.target.value ? Number(e.target.value) : null)}\r\n              className=\"w-full border p-2 rounded\"\r\n            >\r\n              <option value=\"\">Select Department</option>\r\n              {departments.map((dept) => (\r\n                <option key={dept.id} value={dept.id}>\r\n                  {dept.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-1\">Course</label>\r\n            <select\r\n              value={selectedCourse ?? ''}\r\n              onChange={(e) => setSelectedCourse(e.target.value ? Number(e.target.value) : null)}\r\n              className=\"w-full border p-2 rounded\"\r\n              disabled={!selectedDepartment}\r\n            >\r\n              <option value=\"\">Select Course</option>\r\n              {courses.map((course) => (\r\n                <option key={course.id} value={course.id}>\r\n                  {course.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-1\">Search</label>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search by student or subject...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"w-full border p-2 rounded\"\r\n            />\r\n          </div>\r\n\r\n          {showFilters && (\r\n            <>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Grade</label>\r\n                <select\r\n                  value={selectedGrade}\r\n                  onChange={(e) => setSelectedGrade(e.target.value)}\r\n                  className=\"w-full border p-2 rounded\"\r\n                >\r\n                  <option value=\"\">All Grades</option>\r\n                  <option value=\"A+\">A+</option>\r\n                  <option value=\"A\">A</option>\r\n                  <option value=\"A-\">A-</option>\r\n                  <option value=\"B+\">B+</option>\r\n                  <option value=\"B\">B</option>\r\n                  <option value=\"B-\">B-</option>\r\n                  <option value=\"C+\">C+</option>\r\n                  <option value=\"C\">C</option>\r\n                  <option value=\"C-\">C-</option>\r\n                  <option value=\"D+\">D+</option>\r\n                  <option value=\"D\">D</option>\r\n                  <option value=\"F\">F</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Exam Type</label>\r\n                <select\r\n                  value={selectedExamType}\r\n                  onChange={(e) => setSelectedExamType(e.target.value)}\r\n                  className=\"w-full border p-2 rounded\"\r\n                >\r\n                  <option value=\"\">All Types</option>\r\n                  <option value=\"Quiz 1\">Quiz 1</option>\r\n                  <option value=\"Quiz 2\">Quiz 2</option>\r\n                  <option value=\"Assignment 1\">Assignment 1</option>\r\n                  <option value=\"Assignment 2\">Assignment 2</option>\r\n                  <option value=\"Mid Term\">Mid Term</option>\r\n                  <option value=\"Final Exam\">Final Exam</option>\r\n                </select>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Results Table */}\r\n      <div className=\"bg-white rounded-lg shadow border overflow-hidden\">\r\n        <div className=\"px-4 py-3 border-b border-gray-200\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className=\"text-lg font-medium text-gray-900\">\r\n              Results ({filteredResults.length})\r\n            </h3>\r\n            {filteredResults.length > 0 && (\r\n              <label className=\"flex items-center space-x-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedResults.length === filteredResults.length && filteredResults.length > 0}\r\n                  onChange={(e) => handleSelectAll(e.target.checked)}\r\n                  className=\"rounded\"\r\n                />\r\n                <span className=\"text-sm text-gray-700\">Select All</span>\r\n              </label>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full divide-y divide-gray-200\">\r\n            <thead className=\"bg-gray-50\">\r\n              <tr>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedResults.length === filteredResults.length && filteredResults.length > 0}\r\n                    onChange={(e) => handleSelectAll(e.target.checked)}\r\n                    className=\"rounded\"\r\n                  />\r\n                </th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Student</th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Subject</th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Exam Type</th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Marks</th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Grade</th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Percentage</th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Date</th>\r\n                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"bg-white divide-y divide-gray-200\">\r\n              {loading ? (\r\n                <tr>\r\n                  <td colSpan={9} className=\"px-4 py-8 text-center\">\r\n                    <div className=\"flex items-center justify-center\">\r\n                      <svg className=\"animate-spin h-5 w-5 text-blue-600 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                      </svg>\r\n                      Loading results...\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ) : filteredResults.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={9} className=\"px-4 py-8 text-center text-gray-500\">\r\n                    {selectedDepartment && selectedCourse ? 'No results found for the selected filters.' : 'Please select a department and course to view results.'}\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                filteredResults.map((result) => (\r\n                  <tr key={result.id} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-4 py-4 whitespace-nowrap\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedResults.includes(result.id)}\r\n                        onChange={(e) => handleSelectResult(result.id, e.target.checked)}\r\n                        className=\"rounded\"\r\n                      />\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap\">\r\n                      <div className=\"text-sm font-medium text-gray-900\">{result.student_name}</div>\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap\">\r\n                      <div className=\"text-sm text-gray-900\">{result.subject}</div>\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap\">\r\n                      <span className=\"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800\">\r\n                        {result.exam_type}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                      {result.marks}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap\">\r\n                      <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                        result.grade === 'F' ? 'bg-red-100 text-red-800' :\r\n                        result.grade.startsWith('A') ? 'bg-green-100 text-green-800' :\r\n                        result.grade.startsWith('B') ? 'bg-blue-100 text-blue-800' :\r\n                        'bg-yellow-100 text-yellow-800'\r\n                      }`}>\r\n                        {result.grade}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                      {result.percentage.toFixed(1)}%\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                      {new Date(result.exam_date).toLocaleDateString()}\r\n                    </td>\r\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm font-medium\">\r\n                      <button\r\n                        onClick={async () => {\r\n                          if (window.confirm('Delete this result?')) {\r\n                            try {\r\n                              await academicsService.deleteResult(result.result_id);\r\n                              // Refresh the data\r\n                              if (selectedDepartment && selectedCourse) {\r\n                                const response = await academicsService.getResultsByDepartmentCourse(selectedDepartment, selectedCourse);\r\n                                setResults(response.data);\r\n                              }\r\n                            } catch (error) {\r\n                              console.error('Failed to delete result:', error);\r\n                            }\r\n                          }\r\n                        }}\r\n                        className=\"text-red-600 hover:text-red-900 mr-3\"\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Report Card Modal */}\r\n      {showReportCard && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-lg shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto\">\r\n            <div className=\"p-6 border-b\">\r\n              <div className=\"flex justify-between items-center\">\r\n                <h3 className=\"text-xl font-bold text-gray-800\">Generate Student Report Card</h3>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowReportCard(false);\r\n                    setSelectedStudentForReport(null);\r\n                    setReportCardData(null);\r\n                  }}\r\n                  className=\"text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-6\">\r\n              {!selectedStudentForReport ? (\r\n                <div>\r\n                  <p className=\"text-gray-600 mb-4\">Select a student to generate their report card:</p>\r\n                  <div className=\"mb-4\">\r\n                    <SearchableStudentSelect\r\n                      students={Array.from(new Set(filteredResults.map(r => r.student_name)))}\r\n                      selectedStudent={null}\r\n                      onStudentSelect={(studentName) => {\r\n                        if (studentName) {\r\n                          const studentResult = filteredResults.find(r => r.student_name === studentName);\r\n                          setSelectedStudentForReport(studentResult);\r\n                        }\r\n                      }}\r\n                      disabled={filteredResults.length === 0}\r\n                    />\r\n                  </div>\r\n                  {filteredResults.length === 0 && (\r\n                    <p className=\"text-sm text-gray-500 text-center py-4\">\r\n                      No students available. Please select a department and course first.\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              ) : (\r\n                <div>\r\n                  {loadingReport ? (\r\n                    <div className=\"text-center py-8\">\r\n                      <svg className=\"animate-spin h-8 w-8 text-blue-600 mx-auto mb-4\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                      </svg>\r\n                      <p className=\"text-gray-600\">Generating report card...</p>\r\n                    </div>\r\n                  ) : reportCardData ? (\r\n                    <ReportCard\r\n                      student={reportCardData.student}\r\n                      assignedCourses={reportCardData.assignedCourses}\r\n                      results={reportCardData.results}\r\n                      onClose={() => {\r\n                        setShowReportCard(false);\r\n                        setSelectedStudentForReport(null);\r\n                        setReportCardData(null);\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <div className=\"text-center py-8\">\r\n                      <p className=\"text-gray-600 mb-4\">Selected student: <strong>{selectedStudentForReport.student_name}</strong></p>\r\n                      <button\r\n                        onClick={async () => {\r\n                          setLoadingReport(true);\r\n                          try {\r\n                            // Find student ID from results - this might need adjustment based on actual data structure\r\n                            const studentResults = filteredResults.filter(r => r.student_name === selectedStudentForReport.student_name);\r\n                            if (studentResults.length > 0) {\r\n                              // Use student_id as string since it's the primary key\r\n                              const studentId = studentResults[0].student_id;\r\n                              const response = await academicsService.getStudentResults(studentId);\r\n                              setReportCardData(response.data);\r\n                            }\r\n                          } catch (error) {\r\n                            console.error('Failed to fetch student report data:', error);\r\n                            alert('Failed to generate report card. Please try again.');\r\n                          } finally {\r\n                            setLoadingReport(false);\r\n                          }\r\n                        }}\r\n                        className=\"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700\"\r\n                      >\r\n                        Generate Report Card\r\n                      </button>\r\n                      <button\r\n                        onClick={() => setSelectedStudentForReport(null)}\r\n                        className=\"ml-4 text-gray-600 hover:text-gray-800\"\r\n                      >\r\n                        Back to Student List\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResultManagement;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}