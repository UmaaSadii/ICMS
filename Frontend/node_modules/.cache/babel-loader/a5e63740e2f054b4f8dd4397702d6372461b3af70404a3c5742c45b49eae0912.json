{"ast":null,"code":"import _objectSpread from\"c:/UMI/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{academicsService}from'../api/academicsService';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faCreditCard,faCheckCircle,faFilter,faExclamationTriangle,faFileAlt}from'@fortawesome/free-solid-svg-icons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FeeManagement=()=>{var _departments$find2,_semesters$find2,_departments$find3,_semesters$find3,_students$find;const[fees,setFees]=useState([]);const[students,setStudents]=useState([]);const[departments,setDepartments]=useState([]);const[semesters,setSemesters]=useState([]);const[filteredFees,setFilteredFees]=useState([]);const[selectedStudent,setSelectedStudent]=useState(null);const[selectedDepartment,setSelectedDepartment]=useState(null);const[selectedSemester,setSelectedSemester]=useState(null);const[statusFilter,setStatusFilter]=useState('All');const[filteredStudents,setFilteredStudents]=useState([]);const[isModalOpen,setIsModalOpen]=useState(false);const[selectedFee,setSelectedFee]=useState(null);const[paymentAmount,setPaymentAmount]=useState('');const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const[isLoadingStudents,setIsLoadingStudents]=useState(false);const[studentError,setStudentError]=useState(null);const[showReceipt,setShowReceipt]=useState(false);const[lastPayment,setLastPayment]=useState(null);const[showAddFeeModal,setShowAddFeeModal]=useState(false);const[newFeeData,setNewFeeData]=useState({student_id:'',term:'',amount:'',due_date:''});const[showReportModal,setShowReportModal]=useState(false);const[reportData,setReportData]=useState(null);useEffect(()=>{fetchDepartments();fetchStudents();},[]);useEffect(()=>{fetchSemesters();},[selectedDepartment]);// Fetch semesters when department changes\nuseEffect(()=>{if(selectedDepartment){fetchSemesters(selectedDepartment);setSelectedSemester(null);// Reset semester when department changes\n}else{fetchSemesters();// Fetch all semesters if no department selected\n}},[selectedDepartment]);useEffect(()=>{if(selectedStudent){fetchStudentFees(selectedStudent);}else if(selectedDepartment&&selectedSemester){fetchFees();}else{setFees([]);}},[selectedDepartment,selectedSemester,selectedStudent]);useEffect(()=>{filterFees();},[fees,statusFilter]);// Filter students based on selected department and semester\nuseEffect(()=>{let filtered=students;if(selectedDepartment){filtered=filtered.filter(student=>student.department_id===selectedDepartment);}if(selectedSemester){filtered=filtered.filter(student=>student.semester_id===selectedSemester);}setFilteredStudents(filtered);},[students,selectedDepartment,selectedSemester]);// Fetch student details when selectedStudent changes\nuseEffect(()=>{if(selectedStudent){fetchStudent(selectedStudent).then(()=>{fetchStudents();// Refetch all students to include any newly added ones\n});}else{setSelectedDepartment(null);setSelectedSemester(null);}},[selectedStudent]);const fetchDepartments=async()=>{try{const response=await academicsService.getDepartments();console.log('Departments fetched:',response.data);setDepartments(response.data);}catch(err){console.error('Failed to fetch departments:',err);}};const fetchSemesters=async departmentId=>{try{if(departmentId){const response=await academicsService.getSemestersByDepartment(departmentId);setSemesters(response.data);}else{setSemesters([]);// Do not fetch all semesters if no department is selected\n}}catch(err){console.error('Failed to fetch semesters:',err);setSemesters([]);}};const fetchStudents=async()=>{setIsLoadingStudents(true);setStudentError(null);try{const response=await academicsService.getStudents();// Validate and clean student data\nconst validStudents=response.data.filter(student=>{if(!student.id){console.warn('Student missing id:',student);return false;}return true;}).map(student=>_objectSpread(_objectSpread({},student),{},{first_name:student.first_name||'',last_name:student.last_name||'',name:student.name||'',registration_number:student.registration_number||'N/A',department_id:student.department_id||null,semester_id:student.semester_id||null}));setStudents(validStudents);}catch(err){console.error('Failed to fetch students:',err);setStudentError(err.message||'Failed to load students. Please try again.');}finally{setIsLoadingStudents(false);}};const fetchFees=async()=>{try{const filters={};if(selectedDepartment)filters.department=selectedDepartment;if(selectedSemester)filters.semester=selectedSemester;const response=await academicsService.getFees(filters);setFees(response.data);}catch(err){console.error('Failed to fetch fees:',err);}};const fetchStudentFees=async studentId=>{try{const response=await academicsService.getStudentFees(studentId);setFees(response.data);}catch(err){console.error('Failed to fetch student fees:',err);}};const handleCreateFee=async()=>{if(!newFeeData.student_id||!newFeeData.term||!newFeeData.amount||!newFeeData.due_date){setError('All fields are required');return;}setIsLoading(true);setError(null);try{const feeData={student_id:parseInt(newFeeData.student_id),term:newFeeData.term,amount:parseFloat(newFeeData.amount),due_date:newFeeData.due_date};await academicsService.createStudentFee(parseInt(newFeeData.student_id),feeData);// Refresh fees if we're viewing this student's fees\nif(selectedStudent===parseInt(newFeeData.student_id)){await fetchStudentFees(selectedStudent);}setShowAddFeeModal(false);setNewFeeData({student_id:'',term:'',amount:'',due_date:''});}catch(err){setError(err.message||'Failed to create fee record');}finally{setIsLoading(false);}};const generateReport=()=>{var _departments$find,_semesters$find;// Generate fee report based on current filters\nconst report={generatedAt:new Date().toLocaleString(),department:selectedDepartment?(_departments$find=departments.find(d=>d.id===selectedDepartment))===null||_departments$find===void 0?void 0:_departments$find.name:'All Departments',semester:selectedSemester?(_semesters$find=semesters.find(s=>s.id===selectedSemester))===null||_semesters$find===void 0?void 0:_semesters$find.name:'All Semesters',student:selectedStudent?students.find(s=>s.id===selectedStudent):null,totalFees:filteredFees.length,totalAmount:filteredFees.reduce((sum,fee)=>sum+parseFloat(fee.amount),0),totalPaid:filteredFees.reduce((sum,fee)=>sum+parseFloat(fee.paid_amount),0),totalBalance:filteredFees.reduce((sum,fee)=>sum+fee.balance,0),statusBreakdown:{paid:filteredFees.filter(f=>f.status==='Paid').length,unpaid:filteredFees.filter(f=>f.status==='Unpaid').length,partial:filteredFees.filter(f=>f.status==='Partial').length},fees:filteredFees};setReportData(report);setShowReportModal(true);};const fetchStudent=async studentId=>{try{const response=await academicsService.getStudent(studentId);const student=response.data;setSelectedDepartment(student.department_id);setSelectedSemester(student.semester_id);}catch(err){console.error('Failed to fetch student:',err);}};const filterFees=()=>{let filtered=fees;// No need to filter by student since fees are already fetched for selected student\nif(statusFilter!=='All'){filtered=filtered.filter(fee=>fee.status===statusFilter);}setFilteredFees(filtered);};const handlePayment=async()=>{if(!selectedFee||!paymentAmount)return;const amount=parseFloat(paymentAmount);if(amount<=0){setError('Payment amount must be greater than 0');return;}const currentPaid=parseFloat(selectedFee.paid_amount);const totalAmount=parseFloat(selectedFee.amount);const newPaidAmount=currentPaid+amount;if(newPaidAmount>totalAmount){setError('Payment amount exceeds remaining balance');return;}setIsLoading(true);setError(null);try{let newStatus;if(newPaidAmount>=totalAmount){newStatus='Paid';}else if(newPaidAmount>0){newStatus='Partial';}else{newStatus='Unpaid';}const updatedFee=_objectSpread(_objectSpread({},selectedFee),{},{paid_amount:newPaidAmount.toString(),status:newStatus,paid_on:new Date().toISOString().split('T')[0]});await academicsService.updateFee(selectedFee.fee_id,updatedFee);setFees(fees.map(fee=>fee.fee_id===selectedFee.fee_id?updatedFee:fee));// Set last payment for receipt\nsetLastPayment({amount:amount,date:new Date().toLocaleDateString()});setIsModalOpen(false);setShowReceipt(true);setSelectedFee(null);setPaymentAmount('');}catch(err){setError(err.message||'Failed to process payment');}finally{setIsLoading(false);}};const openPaymentModal=fee=>{setSelectedFee(fee);setPaymentAmount('');setIsModalOpen(true);};const formatStudentName=student=>{if(student.first_name&&student.last_name){return\"\".concat(student.first_name.trim(),\" \").concat(student.last_name.trim());}else if(student.name){return student.name.trim();}else{return'Unknown Student';}};const capitalizeFirstLetter=str=>{return str.charAt(0).toUpperCase()+str.slice(1).toLowerCase();};console.log('Rendering FeeManagement with departments:',departments);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 md:p-6 max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"text-indigo-600 text-3xl mr-3\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl md:text-3xl font-bold text-gray-800\",children:\"Fee Management\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>generateReport(),className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faFileAlt,className:\"mr-2\"}),\"Generate Report\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAddFeeModal(true),className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"mr-2\"}),\"Add New Fee\"]})]})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border-l-4 border-red-400 p-4 mb-4 rounded-r-lg flex items-center\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faExclamationTriangle,className:\"text-red-500 mr-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-red-700\",children:error})]}),studentError&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border-l-4 border-red-400 p-4 mb-4 rounded-r-lg flex items-center\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faExclamationTriangle,className:\"text-red-500 mr-3\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-700\",children:[\"Student Data Error: \",studentError]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 bg-white p-4 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faFilter,className:\"text-gray-600 mr-2\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-700\",children:\"Filters\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Select Student\"}),isLoadingStudents?/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center h-10\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-5 w-5 border-b-2 border-indigo-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-gray-600\",children:\"Loading students...\"})]}):studentError?/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded p-2 bg-red-50 text-red-700\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faExclamationTriangle,className:\"mr-2\"}),studentError]}):/*#__PURE__*/_jsxs(\"select\",{value:selectedStudent||'',onChange:e=>setSelectedStudent(e.target.value?parseInt(e.target.value):null),disabled:filteredStudents.length===0,className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:filteredStudents.length===0?'No students available':'Select a student...'}),filteredStudents.map(student=>/*#__PURE__*/_jsxs(\"option\",{value:student.id,children:[capitalizeFirstLetter(formatStudentName(student)),\" (\",student.registration_number,\")\"]},student.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Select Department\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedDepartment||'',onChange:e=>{setSelectedDepartment(e.target.value?parseInt(e.target.value):null);setSelectedStudent(null);// Reset student selection when department changes\n},disabled:!!selectedStudent,className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:selectedStudent?'Auto-selected from student':'Choose a department...'}),departments.map(dept=>/*#__PURE__*/_jsx(\"option\",{value:dept.id,children:dept.name},dept.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Select Semester\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedSemester||'',onChange:e=>{setSelectedSemester(e.target.value?parseInt(e.target.value):null);setSelectedStudent(null);// Reset student selection when semester changes\n},disabled:!selectedDepartment,className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:selectedStudent?'Auto-selected from student':selectedDepartment?semesters.length>0?'Choose a semester...':'No semesters available for this department':'Select department first'}),semesters.map(sem=>/*#__PURE__*/_jsxs(\"option\",{value:sem.id,children:[sem.name,\" (\",sem.semester_code,\")\"]},sem.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Filter by Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"All\",children:\"All\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Paid\",children:\"Paid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Unpaid\",children:\"Unpaid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Partial\",children:\"Partial\"})]})]})]}),selectedDepartment&&selectedSemester&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-blue-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Selected:\"}),\" \",(_departments$find2=departments.find(d=>d.id===selectedDepartment))===null||_departments$find2===void 0?void 0:_departments$find2.name,\" - \",(_semesters$find2=semesters.find(s=>s.id===selectedSemester))===null||_semesters$find2===void 0?void 0:_semesters$find2.name,filteredStudents.length>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2\",children:[\"(\",filteredStudents.length,\" students found)\"]})]})})]}),isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-16 w-16 border-b-4 border-indigo-600\"})}):!selectedDepartment||!selectedSemester?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-8 text-center\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faFilter,className:\"text-gray-400 text-4xl mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"Select Department and Semester\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Please select a department and semester above to view and manage student fees.\"})]}):filteredStudents.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-8 text-center\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faExclamationTriangle,className:\"text-yellow-400 text-4xl mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"No Students Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"No students found for the selected department and semester combination.\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:[\"Fee Records (\",filteredFees.length,\" records)\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[(_departments$find3=departments.find(d=>d.id===selectedDepartment))===null||_departments$find3===void 0?void 0:_departments$find3.name,\" - \",(_semesters$find3=semesters.find(s=>s.id===selectedSemester))===null||_semesters$find3===void 0?void 0:_semesters$find3.name]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Term\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Paid Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Balance\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Due Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Last Payment\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:filteredFees.map(fee=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition-colors duration-200\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:fee.term}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",fee.amount]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",fee.paid_amount]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",fee.balance.toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium \".concat(fee.status==='Paid'?'bg-green-100 text-green-800':fee.status==='Unpaid'?'bg-red-100 text-red-800':'bg-yellow-100 text-yellow-800'),children:[fee.status==='Paid'&&/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheckCircle,className:\"mr-1\"}),fee.status]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:fee.due_date}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:fee.paid_on?new Date(fee.paid_on).toLocaleDateString():'No payments'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm font-medium\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>openPaymentModal(fee),className:\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"mr-2\"}),\"Make Payment\"]})})]},fee.fee_id))})]})})]}),isModalOpen&&selectedFee&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"text-indigo-600 text-xl mr-2\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Make Payment\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Fee for \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:selectedFee.term})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Total Amount: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"$\",selectedFee.amount]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Balance: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"$\",selectedFee.balance.toFixed(2)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Payment Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:paymentAmount,onChange:e=>setPaymentAmount(e.target.value),className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500\",placeholder:\"Enter amount\",min:\"0.01\",step:\"0.01\",max:selectedFee?(parseFloat(selectedFee.amount)-parseFloat(selectedFee.paid_amount)).toFixed(2):undefined}),selectedFee&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:[\"Maximum: $\",(parseFloat(selectedFee.amount)-parseFloat(selectedFee.paid_amount)).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsModalOpen(false),className:\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200\",children:\"Cancel\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handlePayment,disabled:isLoading||!paymentAmount,className:\"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 transition-colors duration-200\",children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}):/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"mr-2\"}),isLoading?'Processing...':'Pay']})]})]})})}),showReceipt&&selectedStudent&&lastPayment&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Payment Receipt\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowReceipt(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheckCircle,size:\"lg\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-b border-gray-200 py-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:\"University Fee Payment\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Receipt #\",Date.now()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Student:\"}),/*#__PURE__*/_jsx(\"span\",{children:students.find(s=>s.id===selectedStudent)?formatStudentName(students.find(s=>s.id===selectedStudent)):'Unknown'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Registration:\"}),/*#__PURE__*/_jsx(\"span\",{children:((_students$find=students.find(s=>s.id===selectedStudent))===null||_students$find===void 0?void 0:_students$find.registration_number)||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Payment Date:\"}),/*#__PURE__*/_jsx(\"span\",{children:lastPayment.date})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Amount Paid:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold text-green-600\",children:[\"$\",lastPayment.amount.toFixed(2)]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-4\",children:\"Thank you for your payment. This receipt serves as proof of payment.\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.print(),className:\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"mr-2\"}),\"Print Receipt\"]})]})]})})}),showAddFeeModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"text-green-600 text-xl mr-2\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Add New Fee Record\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Select Student\"}),/*#__PURE__*/_jsxs(\"select\",{value:newFeeData.student_id,onChange:e=>setNewFeeData(_objectSpread(_objectSpread({},newFeeData),{},{student_id:e.target.value})),className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a student...\"}),students.map(student=>/*#__PURE__*/_jsxs(\"option\",{value:student.id,children:[capitalizeFirstLetter(formatStudentName(student)),\" (\",student.registration_number,\")\"]},student.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Term\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newFeeData.term,onChange:e=>setNewFeeData(_objectSpread(_objectSpread({},newFeeData),{},{term:e.target.value})),className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\",placeholder:\"e.g., Fall-2024, Semester-1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newFeeData.amount,onChange:e=>setNewFeeData(_objectSpread(_objectSpread({},newFeeData),{},{amount:e.target.value})),className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\",placeholder:\"Enter amount\",min:\"0.01\",step:\"0.01\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Due Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:newFeeData.due_date,onChange:e=>setNewFeeData(_objectSpread(_objectSpread({},newFeeData),{},{due_date:e.target.value})),className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowAddFeeModal(false);setNewFeeData({student_id:'',term:'',amount:'',due_date:''});},className:\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200\",children:\"Cancel\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleCreateFee,disabled:isLoading,className:\"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 transition-colors duration-200\",children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}):/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCreditCard,className:\"mr-2\"}),isLoading?'Creating...':'Create Fee']})]})]})})}),showReportModal&&reportData&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-auto max-h-[90vh] overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faFileAlt,className:\"text-blue-600 text-xl mr-2\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Fee Report\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.print(),className:\"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faFileAlt,className:\"mr-2\"}),\"Print\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowReportModal(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheckCircle,size:\"lg\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:reportData.totalFees}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-800\",children:\"Total Fees\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-green-600\",children:[\"$\",reportData.totalAmount.toFixed(2)]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-800\",children:\"Total Amount\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-yellow-600\",children:[\"$\",reportData.totalPaid.toFixed(2)]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-yellow-800\",children:\"Total Paid\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold text-red-600\",children:[\"$\",reportData.totalBalance.toFixed(2)]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-red-800\",children:\"Total Balance\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-semibold text-green-600\",children:reportData.statusBreakdown.paid}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Paid\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-semibold text-red-600\",children:reportData.statusBreakdown.unpaid}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Unpaid\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-semibold text-yellow-600\",children:reportData.statusBreakdown.partial}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Partial\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 mb-4\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Report Generated:\"}),\" \",reportData.generatedAt]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Department:\"}),\" \",reportData.department]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Semester:\"}),\" \",reportData.semester]}),reportData.student&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Student:\"}),\" \",capitalizeFirstLetter(formatStudentName(reportData.student)),\" (\",reportData.student.registration_number,\")\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Student\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Term\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Paid\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Balance\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Due Date\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:reportData.fees.map(fee=>{const student=students.find(s=>s.id===fee.student);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:student?capitalizeFirstLetter(formatStudentName(student)):'Unknown'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:fee.term}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",fee.amount]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",fee.paid_amount]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",fee.balance.toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium \".concat(fee.status==='Paid'?'bg-green-100 text-green-800':fee.status==='Unpaid'?'bg-red-100 text-red-800':'bg-yellow-100 text-yellow-800'),children:fee.status})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\",children:fee.due_date})]},fee.fee_id);})})]})})]})})})]});};export default FeeManagement;","map":{"version":3,"names":["React","useState","useEffect","academicsService","FontAwesomeIcon","faCreditCard","faCheckCircle","faFilter","faExclamationTriangle","faFileAlt","jsx","_jsx","jsxs","_jsxs","FeeManagement","_departments$find2","_semesters$find2","_departments$find3","_semesters$find3","_students$find","fees","setFees","students","setStudents","departments","setDepartments","semesters","setSemesters","filteredFees","setFilteredFees","selectedStudent","setSelectedStudent","selectedDepartment","setSelectedDepartment","selectedSemester","setSelectedSemester","statusFilter","setStatusFilter","filteredStudents","setFilteredStudents","isModalOpen","setIsModalOpen","selectedFee","setSelectedFee","paymentAmount","setPaymentAmount","isLoading","setIsLoading","error","setError","isLoadingStudents","setIsLoadingStudents","studentError","setStudentError","showReceipt","setShowReceipt","lastPayment","setLastPayment","showAddFeeModal","setShowAddFeeModal","newFeeData","setNewFeeData","student_id","term","amount","due_date","showReportModal","setShowReportModal","reportData","setReportData","fetchDepartments","fetchStudents","fetchSemesters","fetchStudentFees","fetchFees","filterFees","filtered","filter","student","department_id","semester_id","fetchStudent","then","response","getDepartments","console","log","data","err","departmentId","getSemestersByDepartment","getStudents","validStudents","id","warn","map","_objectSpread","first_name","last_name","name","registration_number","message","filters","department","semester","getFees","studentId","getStudentFees","handleCreateFee","feeData","parseInt","parseFloat","createStudentFee","generateReport","_departments$find","_semesters$find","report","generatedAt","Date","toLocaleString","find","d","s","totalFees","length","totalAmount","reduce","sum","fee","totalPaid","paid_amount","totalBalance","balance","statusBreakdown","paid","f","status","unpaid","partial","getStudent","handlePayment","currentPaid","newPaidAmount","newStatus","updatedFee","toString","paid_on","toISOString","split","updateFee","fee_id","date","toLocaleDateString","openPaymentModal","formatStudentName","concat","trim","capitalizeFirstLetter","str","charAt","toUpperCase","slice","toLowerCase","className","children","icon","onClick","value","onChange","e","target","disabled","dept","sem","semester_code","toFixed","type","placeholder","min","step","max","undefined","size","now","window","print"],"sources":["c:/UMI/Frontend/src/components/FeeManagement.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { academicsService } from '../api/academicsService';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCreditCard, faCheckCircle, faFilter, faExclamationTriangle, faFileAlt } from '@fortawesome/free-solid-svg-icons';\n\ninterface Fee {\n  fee_id: number;\n  student: number;\n  term: string;\n  amount: string;\n  paid_amount: string;\n  status: 'Paid' | 'Unpaid' | 'Partial';\n  due_date: string;\n  paid_on?: string;\n  balance: number;\n  department_id: number;\n  semester_id: number;\n}\n\ninterface Student {\n  id: number;\n  first_name?: string;\n  last_name?: string;\n  name?: string;\n  registration_number?: string;\n  department_id?: number;\n  semester_id?: number;\n}\n\ninterface Department {\n  id: number;\n  name: string;\n}\n\ninterface Semester {\n  id: number;\n  name: string;\n  semester_code: string;\n}\n\nconst FeeManagement: React.FC = () => {\n  const [fees, setFees] = useState<Fee[]>([]);\n  const [students, setStudents] = useState<Student[]>([]);\n  const [departments, setDepartments] = useState<Department[]>([]);\n  const [semesters, setSemesters] = useState<Semester[]>([]);\n  const [filteredFees, setFilteredFees] = useState<Fee[]>([]);\n  const [selectedStudent, setSelectedStudent] = useState<number | null>(null);\n  const [selectedDepartment, setSelectedDepartment] = useState<number | null>(null);\n  const [selectedSemester, setSelectedSemester] = useState<number | null>(null);\n  const [statusFilter, setStatusFilter] = useState<string>('All');\n  const [filteredStudents, setFilteredStudents] = useState<Student[]>([]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedFee, setSelectedFee] = useState<Fee | null>(null);\n  const [paymentAmount, setPaymentAmount] = useState<string>('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isLoadingStudents, setIsLoadingStudents] = useState(false);\n  const [studentError, setStudentError] = useState<string | null>(null);\n  const [showReceipt, setShowReceipt] = useState(false);\n  const [lastPayment, setLastPayment] = useState<{amount: number, date: string} | null>(null);\n  const [showAddFeeModal, setShowAddFeeModal] = useState(false);\n  const [newFeeData, setNewFeeData] = useState({\n    student_id: '',\n    term: '',\n    amount: '',\n    due_date: ''\n  });\n  const [showReportModal, setShowReportModal] = useState(false);\n  const [reportData, setReportData] = useState<any>(null);\n\n  useEffect(() => {\n    fetchDepartments();\n    fetchStudents();\n  }, []);\n\n  useEffect(() => {\n    fetchSemesters();\n  }, [selectedDepartment]);\n\n  // Fetch semesters when department changes\n  useEffect(() => {\n    if (selectedDepartment) {\n      fetchSemesters(selectedDepartment);\n      setSelectedSemester(null); // Reset semester when department changes\n    } else {\n      fetchSemesters(); // Fetch all semesters if no department selected\n    }\n  }, [selectedDepartment]);\n\n  useEffect(() => {\n    if (selectedStudent) {\n      fetchStudentFees(selectedStudent);\n    } else if (selectedDepartment && selectedSemester) {\n      fetchFees();\n    } else {\n      setFees([]);\n    }\n  }, [selectedDepartment, selectedSemester, selectedStudent]);\n\n  useEffect(() => {\n    filterFees();\n  }, [fees, statusFilter]);\n\n  // Filter students based on selected department and semester\n  useEffect(() => {\n    let filtered = students;\n    if (selectedDepartment) {\n      filtered = filtered.filter(student => student.department_id === selectedDepartment);\n    }\n    if (selectedSemester) {\n      filtered = filtered.filter(student => student.semester_id === selectedSemester);\n    }\n    setFilteredStudents(filtered);\n  }, [students, selectedDepartment, selectedSemester]);\n\n  // Fetch student details when selectedStudent changes\n  useEffect(() => {\n    if (selectedStudent) {\n      fetchStudent(selectedStudent).then(() => {\n        fetchStudents(); // Refetch all students to include any newly added ones\n      });\n    } else {\n      setSelectedDepartment(null);\n      setSelectedSemester(null);\n    }\n  }, [selectedStudent]);\n\n  const fetchDepartments = async () => {\n    try {\n      const response = await academicsService.getDepartments();\n      console.log('Departments fetched:', response.data);\n      setDepartments(response.data);\n    } catch (err) {\n      console.error('Failed to fetch departments:', err);\n    }\n  };\n\n  const fetchSemesters = async (departmentId?: number) => {\n    try {\n      if (departmentId) {\n        const response = await academicsService.getSemestersByDepartment(departmentId);\n        setSemesters(response.data);\n      } else {\n        setSemesters([]); // Do not fetch all semesters if no department is selected\n      }\n    } catch (err) {\n      console.error('Failed to fetch semesters:', err);\n      setSemesters([]);\n    }\n  };\n\n  const fetchStudents = async () => {\n    setIsLoadingStudents(true);\n    setStudentError(null);\n    try {\n      const response = await academicsService.getStudents();\n      // Validate and clean student data\n      const validStudents = response.data.filter((student: any) => {\n        if (!student.id) {\n          console.warn('Student missing id:', student);\n          return false;\n        }\n        return true;\n      }).map((student: any) => ({\n        ...student,\n        first_name: student.first_name || '',\n        last_name: student.last_name || '',\n        name: student.name || '',\n        registration_number: student.registration_number || 'N/A',\n        department_id: student.department_id || null,\n        semester_id: student.semester_id || null,\n      }));\n      setStudents(validStudents);\n    } catch (err: any) {\n      console.error('Failed to fetch students:', err);\n      setStudentError(err.message || 'Failed to load students. Please try again.');\n    } finally {\n      setIsLoadingStudents(false);\n    }\n  };\n\n  const fetchFees = async () => {\n    try {\n      const filters: { department?: number; semester?: number } = {};\n      if (selectedDepartment) filters.department = selectedDepartment;\n      if (selectedSemester) filters.semester = selectedSemester;\n      const response = await academicsService.getFees(filters);\n      setFees(response.data);\n    } catch (err) {\n      console.error('Failed to fetch fees:', err);\n    }\n  };\n\n  const fetchStudentFees = async (studentId: number) => {\n    try {\n      const response = await academicsService.getStudentFees(studentId);\n      setFees(response.data);\n    } catch (err) {\n      console.error('Failed to fetch student fees:', err);\n    }\n  };\n\n  const handleCreateFee = async () => {\n    if (!newFeeData.student_id || !newFeeData.term || !newFeeData.amount || !newFeeData.due_date) {\n      setError('All fields are required');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n    try {\n      const feeData = {\n        student_id: parseInt(newFeeData.student_id),\n        term: newFeeData.term,\n        amount: parseFloat(newFeeData.amount),\n        due_date: newFeeData.due_date\n      };\n\n      await academicsService.createStudentFee(parseInt(newFeeData.student_id), feeData);\n\n      // Refresh fees if we're viewing this student's fees\n      if (selectedStudent === parseInt(newFeeData.student_id)) {\n        await fetchStudentFees(selectedStudent);\n      }\n\n      setShowAddFeeModal(false);\n      setNewFeeData({\n        student_id: '',\n        term: '',\n        amount: '',\n        due_date: ''\n      });\n    } catch (err: any) {\n      setError(err.message || 'Failed to create fee record');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const generateReport = () => {\n    // Generate fee report based on current filters\n    const report = {\n      generatedAt: new Date().toLocaleString(),\n      department: selectedDepartment ? departments.find(d => d.id === selectedDepartment)?.name : 'All Departments',\n      semester: selectedSemester ? semesters.find(s => s.id === selectedSemester)?.name : 'All Semesters',\n      student: selectedStudent ? students.find(s => s.id === selectedStudent) : null,\n      totalFees: filteredFees.length,\n      totalAmount: filteredFees.reduce((sum, fee) => sum + parseFloat(fee.amount), 0),\n      totalPaid: filteredFees.reduce((sum, fee) => sum + parseFloat(fee.paid_amount), 0),\n      totalBalance: filteredFees.reduce((sum, fee) => sum + fee.balance, 0),\n      statusBreakdown: {\n        paid: filteredFees.filter(f => f.status === 'Paid').length,\n        unpaid: filteredFees.filter(f => f.status === 'Unpaid').length,\n        partial: filteredFees.filter(f => f.status === 'Partial').length,\n      },\n      fees: filteredFees\n    };\n\n    setReportData(report);\n    setShowReportModal(true);\n  };\n\n  const fetchStudent = async (studentId: number) => {\n    try {\n      const response = await academicsService.getStudent(studentId);\n      const student = response.data;\n      setSelectedDepartment(student.department_id);\n      setSelectedSemester(student.semester_id);\n    } catch (err) {\n      console.error('Failed to fetch student:', err);\n    }\n  };\n\n  const filterFees = () => {\n    let filtered = fees;\n    // No need to filter by student since fees are already fetched for selected student\n    if (statusFilter !== 'All') {\n      filtered = filtered.filter(fee => fee.status === statusFilter);\n    }\n    setFilteredFees(filtered);\n  };\n\n  const handlePayment = async () => {\n    if (!selectedFee || !paymentAmount) return;\n\n    const amount = parseFloat(paymentAmount);\n    if (amount <= 0) {\n      setError('Payment amount must be greater than 0');\n      return;\n    }\n\n    const currentPaid = parseFloat(selectedFee.paid_amount);\n    const totalAmount = parseFloat(selectedFee.amount);\n    const newPaidAmount = currentPaid + amount;\n\n    if (newPaidAmount > totalAmount) {\n      setError('Payment amount exceeds remaining balance');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n    try {\n      let newStatus: 'Paid' | 'Unpaid' | 'Partial';\n      if (newPaidAmount >= totalAmount) {\n        newStatus = 'Paid';\n      } else if (newPaidAmount > 0) {\n        newStatus = 'Partial';\n      } else {\n        newStatus = 'Unpaid';\n      }\n\n      const updatedFee: Fee = {\n        ...selectedFee,\n        paid_amount: newPaidAmount.toString(),\n        status: newStatus,\n        paid_on: new Date().toISOString().split('T')[0],\n      };\n\n      await academicsService.updateFee(selectedFee.fee_id, updatedFee);\n      setFees(fees.map(fee => fee.fee_id === selectedFee.fee_id ? updatedFee as Fee : fee));\n\n      // Set last payment for receipt\n      setLastPayment({\n        amount: amount,\n        date: new Date().toLocaleDateString()\n      });\n\n      setIsModalOpen(false);\n      setShowReceipt(true);\n      setSelectedFee(null);\n      setPaymentAmount('');\n    } catch (err: any) {\n      setError(err.message || 'Failed to process payment');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const openPaymentModal = (fee: Fee) => {\n    setSelectedFee(fee);\n    setPaymentAmount('');\n    setIsModalOpen(true);\n  };\n\n  const formatStudentName = (student: Student) => {\n    if (student.first_name && student.last_name) {\n      return `${student.first_name.trim()} ${student.last_name.trim()}`;\n    } else if (student.name) {\n      return student.name.trim();\n    } else {\n      return 'Unknown Student';\n    }\n  };\n\n  const capitalizeFirstLetter = (str: string) => {\n    return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n  };\n\n  console.log('Rendering FeeManagement with departments:', departments);\n\n  return (\n    <div className=\"p-4 md:p-6 max-w-7xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center\">\n          <FontAwesomeIcon icon={faCreditCard} className=\"text-indigo-600 text-3xl mr-3\" />\n          <h1 className=\"text-2xl md:text-3xl font-bold text-gray-800\">Fee Management</h1>\n        </div>\n        <div className=\"flex space-x-3\">\n          <button\n            onClick={() => generateReport()}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200\"\n          >\n            <FontAwesomeIcon icon={faFileAlt} className=\"mr-2\" />\n            Generate Report\n          </button>\n          <button\n            onClick={() => setShowAddFeeModal(true)}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200\"\n          >\n            <FontAwesomeIcon icon={faCreditCard} className=\"mr-2\" />\n            Add New Fee\n          </button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"bg-red-50 border-l-4 border-red-400 p-4 mb-4 rounded-r-lg flex items-center\">\n          <FontAwesomeIcon icon={faExclamationTriangle} className=\"text-red-500 mr-3\" />\n          <span className=\"text-red-700\">{error}</span>\n        </div>\n      )}\n\n      {studentError && (\n        <div className=\"bg-red-50 border-l-4 border-red-400 p-4 mb-4 rounded-r-lg flex items-center\">\n          <FontAwesomeIcon icon={faExclamationTriangle} className=\"text-red-500 mr-3\" />\n          <span className=\"text-red-700\">Student Data Error: {studentError}</span>\n        </div>\n      )}\n\n      <div className=\"mb-6 bg-white p-4 rounded-lg shadow-sm\">\n        <div className=\"flex items-center mb-4\">\n          <FontAwesomeIcon icon={faFilter} className=\"text-gray-600 mr-2\" />\n          <h2 className=\"text-lg font-semibold text-gray-700\">Filters</h2>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">Select Student</label>\n            {isLoadingStudents ? (\n              <div className=\"flex justify-center items-center h-10\">\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-indigo-600\"></div>\n                <span className=\"ml-2 text-gray-600\">Loading students...</span>\n              </div>\n            ) : studentError ? (\n              <div className=\"border rounded p-2 bg-red-50 text-red-700\">\n                <FontAwesomeIcon icon={faExclamationTriangle} className=\"mr-2\" />\n                {studentError}\n              </div>\n            ) : (\n              <select\n                value={selectedStudent || ''}\n                onChange={(e) => setSelectedStudent(e.target.value ? parseInt(e.target.value) : null)}\n                disabled={filteredStudents.length === 0}\n                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\"\n              >\n                <option value=\"\">\n                  {filteredStudents.length === 0 ? 'No students available' : 'Select a student...'}\n                </option>\n                {filteredStudents.map(student => (\n                  <option key={student.id} value={student.id}>\n                    {capitalizeFirstLetter(formatStudentName(student))} ({student.registration_number})\n                  </option>\n                ))}\n              </select>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">Select Department</label>\n            <select\n              value={selectedDepartment || ''}\n              onChange={(e) => {\n                setSelectedDepartment(e.target.value ? parseInt(e.target.value) : null);\n                setSelectedStudent(null); // Reset student selection when department changes\n              }}\n              disabled={!!selectedStudent}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\"\n            >\n              <option value=\"\">\n                {selectedStudent ? 'Auto-selected from student' : 'Choose a department...'}\n              </option>\n              {departments.map(dept => (\n                <option key={dept.id} value={dept.id}>\n                  {dept.name}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">Select Semester</label>\n            <select\n              value={selectedSemester || ''}\n              onChange={(e) => {\n                setSelectedSemester(e.target.value ? parseInt(e.target.value) : null);\n                setSelectedStudent(null); // Reset student selection when semester changes\n              }}\n              disabled={!selectedDepartment}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed\"\n            >\n              <option value=\"\">\n                {selectedStudent ? 'Auto-selected from student' : selectedDepartment ? (semesters.length > 0 ? 'Choose a semester...' : 'No semesters available for this department') : 'Select department first'}\n              </option>\n              {semesters.map(sem => (\n                <option key={sem.id} value={sem.id}>\n                  {sem.name} ({sem.semester_code})\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">Filter by Status</label>\n            <select\n              value={statusFilter}\n              onChange={(e) => setStatusFilter(e.target.value)}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n            >\n              <option value=\"All\">All</option>\n              <option value=\"Paid\">Paid</option>\n              <option value=\"Unpaid\">Unpaid</option>\n              <option value=\"Partial\">Partial</option>\n            </select>\n          </div>\n        </div>\n\n        {(selectedDepartment && selectedSemester) && (\n          <div className=\"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200\">\n            <p className=\"text-sm text-blue-800\">\n              <strong>Selected:</strong> {departments.find(d => d.id === selectedDepartment)?.name} - {semesters.find(s => s.id === selectedSemester)?.name}\n              {filteredStudents.length > 0 && (\n                <span className=\"ml-2\">({filteredStudents.length} students found)</span>\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n\n      {isLoading ? (\n        <div className=\"flex justify-center items-center h-64\">\n          <div className=\"animate-spin rounded-full h-16 w-16 border-b-4 border-indigo-600\"></div>\n        </div>\n      ) : !selectedDepartment || !selectedSemester ? (\n        <div className=\"bg-white rounded-lg shadow-sm p-8 text-center\">\n          <FontAwesomeIcon icon={faFilter} className=\"text-gray-400 text-4xl mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Select Department and Semester</h3>\n          <p className=\"text-gray-600\">Please select a department and semester above to view and manage student fees.</p>\n        </div>\n      ) : filteredStudents.length === 0 ? (\n        <div className=\"bg-white rounded-lg shadow-sm p-8 text-center\">\n          <FontAwesomeIcon icon={faExclamationTriangle} className=\"text-yellow-400 text-4xl mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No Students Found</h3>\n          <p className=\"text-gray-600\">No students found for the selected department and semester combination.</p>\n        </div>\n      ) : (\n        <div className=\"bg-white rounded-lg shadow-sm overflow-hidden\">\n          <div className=\"px-6 py-4 border-b border-gray-200\">\n            <h3 className=\"text-lg font-medium text-gray-900\">\n              Fee Records ({filteredFees.length} records)\n            </h3>\n            <p className=\"text-sm text-gray-600\">\n              {departments.find(d => d.id === selectedDepartment)?.name} - {semesters.find(s => s.id === selectedSemester)?.name}\n            </p>\n          </div>\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Term</th>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Amount</th>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Paid Amount</th>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Balance</th>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Due Date</th>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Last Payment</th>\n                  <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {filteredFees.map(fee => (\n                  <tr key={fee.fee_id} className=\"hover:bg-gray-50 transition-colors duration-200\">\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">{fee.term}</td>\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">${fee.amount}</td>\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">${fee.paid_amount}</td>\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">${fee.balance.toFixed(2)}</td>\n                    <td className=\"px-4 py-4 whitespace-nowrap\">\n                      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                        fee.status === 'Paid' ? 'bg-green-100 text-green-800' :\n                        fee.status === 'Unpaid' ? 'bg-red-100 text-red-800' :\n                        'bg-yellow-100 text-yellow-800'\n                      }`}>\n                        {fee.status === 'Paid' && <FontAwesomeIcon icon={faCheckCircle} className=\"mr-1\" />}\n                        {fee.status}\n                      </span>\n                    </td>\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">{fee.due_date}</td>\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {fee.paid_on ? new Date(fee.paid_on).toLocaleDateString() : 'No payments'}\n                    </td>\n                    <td className=\"px-4 py-4 whitespace-nowrap text-sm font-medium\">\n                      <button\n                        onClick={() => openPaymentModal(fee)}\n                        className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200\"\n                      >\n                        <FontAwesomeIcon icon={faCreditCard} className=\"mr-2\" />\n                        Make Payment\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {isModalOpen && selectedFee && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center mb-4\">\n                <FontAwesomeIcon icon={faCreditCard} className=\"text-indigo-600 text-xl mr-2\" />\n                <h2 className=\"text-xl font-bold text-gray-800\">Make Payment</h2>\n              </div>\n              <div className=\"mb-4\">\n                <p className=\"text-gray-600\">Fee for <span className=\"font-semibold\">{selectedFee.term}</span></p>\n                <p className=\"text-gray-600\">Total Amount: <span className=\"font-semibold\">${selectedFee.amount}</span></p>\n                <p className=\"text-gray-600\">Balance: <span className=\"font-semibold\">${selectedFee.balance.toFixed(2)}</span></p>\n              </div>\n              <div className=\"mb-4\">\n                <label className=\"block text-gray-700 text-sm font-bold mb-2\">Payment Amount</label>\n                <input\n                  type=\"number\"\n                  value={paymentAmount}\n                  onChange={(e) => setPaymentAmount(e.target.value)}\n                  className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n                  placeholder=\"Enter amount\"\n                  min=\"0.01\"\n                  step=\"0.01\"\n                  max={selectedFee ? (parseFloat(selectedFee.amount) - parseFloat(selectedFee.paid_amount)).toFixed(2) : undefined}\n                />\n                {selectedFee && (\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Maximum: ${(parseFloat(selectedFee.amount) - parseFloat(selectedFee.paid_amount)).toFixed(2)}\n                  </p>\n                )}\n              </div>\n              <div className=\"flex justify-end space-x-3\">\n                <button\n                  onClick={() => setIsModalOpen(false)}\n                  className=\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={handlePayment}\n                  disabled={isLoading || !paymentAmount}\n                  className=\"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 transition-colors duration-200\"\n                >\n                  {isLoading ? <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div> : <FontAwesomeIcon icon={faCreditCard} className=\"mr-2\" />}\n                  {isLoading ? 'Processing...' : 'Pay'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showReceipt && selectedStudent && lastPayment && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-800\">Payment Receipt</h2>\n                <button\n                  onClick={() => setShowReceipt(false)}\n                  className=\"text-gray-500 hover:text-gray-700\"\n                >\n                  <FontAwesomeIcon icon={faCheckCircle} size=\"lg\" />\n                </button>\n              </div>\n\n              <div className=\"border-t border-b border-gray-200 py-4 mb-4\">\n                <div className=\"text-center mb-4\">\n                  <h3 className=\"text-lg font-semibold text-gray-800\">University Fee Payment</h3>\n                  <p className=\"text-sm text-gray-600\">Receipt #{Date.now()}</p>\n                </div>\n\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium\">Student:</span>\n                    <span>{students.find(s => s.id === selectedStudent) ? formatStudentName(students.find(s => s.id === selectedStudent)!) : 'Unknown'}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium\">Registration:</span>\n                    <span>{students.find(s => s.id === selectedStudent)?.registration_number || 'N/A'}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium\">Payment Date:</span>\n                    <span>{lastPayment.date}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium\">Amount Paid:</span>\n                    <span className=\"font-semibold text-green-600\">${lastPayment.amount.toFixed(2)}</span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"text-center\">\n                <p className=\"text-xs text-gray-500 mb-4\">\n                  Thank you for your payment. This receipt serves as proof of payment.\n                </p>\n                <button\n                  onClick={() => window.print()}\n                  className=\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\"\n                >\n                  <FontAwesomeIcon icon={faCreditCard} className=\"mr-2\" />\n                  Print Receipt\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showAddFeeModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center mb-4\">\n                <FontAwesomeIcon icon={faCreditCard} className=\"text-green-600 text-xl mr-2\" />\n                <h2 className=\"text-xl font-bold text-gray-800\">Add New Fee Record</h2>\n              </div>\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-gray-700 text-sm font-bold mb-2\">Select Student</label>\n                  <select\n                    value={newFeeData.student_id}\n                    onChange={(e) => setNewFeeData({...newFeeData, student_id: e.target.value})}\n                    className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\"\n                  >\n                    <option value=\"\">Select a student...</option>\n                    {students.map(student => (\n                      <option key={student.id} value={student.id}>\n                        {capitalizeFirstLetter(formatStudentName(student))} ({student.registration_number})\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-gray-700 text-sm font-bold mb-2\">Term</label>\n                  <input\n                    type=\"text\"\n                    value={newFeeData.term}\n                    onChange={(e) => setNewFeeData({...newFeeData, term: e.target.value})}\n                    className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\"\n                    placeholder=\"e.g., Fall-2024, Semester-1\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-gray-700 text-sm font-bold mb-2\">Amount</label>\n                  <input\n                    type=\"number\"\n                    value={newFeeData.amount}\n                    onChange={(e) => setNewFeeData({...newFeeData, amount: e.target.value})}\n                    className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\"\n                    placeholder=\"Enter amount\"\n                    min=\"0.01\"\n                    step=\"0.01\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-gray-700 text-sm font-bold mb-2\">Due Date</label>\n                  <input\n                    type=\"date\"\n                    value={newFeeData.due_date}\n                    onChange={(e) => setNewFeeData({...newFeeData, due_date: e.target.value})}\n                    className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-green-500\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <button\n                  onClick={() => {\n                    setShowAddFeeModal(false);\n                    setNewFeeData({\n                      student_id: '',\n                      term: '',\n                      amount: '',\n                      due_date: ''\n                    });\n                  }}\n                  className=\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={handleCreateFee}\n                  disabled={isLoading}\n                  className=\"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 transition-colors duration-200\"\n                >\n                  {isLoading ? <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div> : <FontAwesomeIcon icon={faCreditCard} className=\"mr-2\" />}\n                  {isLoading ? 'Creating...' : 'Create Fee'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showReportModal && reportData && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-auto max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <div className=\"flex items-center\">\n                  <FontAwesomeIcon icon={faFileAlt} className=\"text-blue-600 text-xl mr-2\" />\n                  <h2 className=\"text-xl font-bold text-gray-800\">Fee Report</h2>\n                </div>\n                <div className=\"flex space-x-2\">\n                  <button\n                    onClick={() => window.print()}\n                    className=\"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\"\n                  >\n                    <FontAwesomeIcon icon={faFileAlt} className=\"mr-2\" />\n                    Print\n                  </button>\n                  <button\n                    onClick={() => setShowReportModal(false)}\n                    className=\"text-gray-500 hover:text-gray-700\"\n                  >\n                    <FontAwesomeIcon icon={faCheckCircle} size=\"lg\" />\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"mb-6\">\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\">\n                  <div className=\"bg-blue-50 p-3 rounded-lg\">\n                    <div className=\"text-2xl font-bold text-blue-600\">{reportData.totalFees}</div>\n                    <div className=\"text-sm text-blue-800\">Total Fees</div>\n                  </div>\n                  <div className=\"bg-green-50 p-3 rounded-lg\">\n                    <div className=\"text-2xl font-bold text-green-600\">${reportData.totalAmount.toFixed(2)}</div>\n                    <div className=\"text-sm text-green-800\">Total Amount</div>\n                  </div>\n                  <div className=\"bg-yellow-50 p-3 rounded-lg\">\n                    <div className=\"text-2xl font-bold text-yellow-600\">${reportData.totalPaid.toFixed(2)}</div>\n                    <div className=\"text-sm text-yellow-800\">Total Paid</div>\n                  </div>\n                  <div className=\"bg-red-50 p-3 rounded-lg\">\n                    <div className=\"text-2xl font-bold text-red-600\">${reportData.totalBalance.toFixed(2)}</div>\n                    <div className=\"text-sm text-red-800\">Total Balance</div>\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-3 gap-4 mb-4\">\n                  <div className=\"text-center\">\n                    <div className=\"text-lg font-semibold text-green-600\">{reportData.statusBreakdown.paid}</div>\n                    <div className=\"text-sm text-gray-600\">Paid</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-lg font-semibold text-red-600\">{reportData.statusBreakdown.unpaid}</div>\n                    <div className=\"text-sm text-gray-600\">Unpaid</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-lg font-semibold text-yellow-600\">{reportData.statusBreakdown.partial}</div>\n                    <div className=\"text-sm text-gray-600\">Partial</div>\n                  </div>\n                </div>\n\n                <div className=\"text-sm text-gray-600 mb-4\">\n                  <p><strong>Report Generated:</strong> {reportData.generatedAt}</p>\n                  <p><strong>Department:</strong> {reportData.department}</p>\n                  <p><strong>Semester:</strong> {reportData.semester}</p>\n                  {reportData.student && (\n                    <p><strong>Student:</strong> {capitalizeFirstLetter(formatStudentName(reportData.student))} ({reportData.student.registration_number})</p>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Student</th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Term</th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Amount</th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Paid</th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Balance</th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\n                      <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Due Date</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\n                    {reportData.fees.map((fee: Fee) => {\n                      const student = students.find(s => s.id === fee.student);\n                      return (\n                        <tr key={fee.fee_id}>\n                          <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">\n                            {student ? capitalizeFirstLetter(formatStudentName(student)) : 'Unknown'}\n                          </td>\n                          <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">{fee.term}</td>\n                          <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">${fee.amount}</td>\n                          <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">${fee.paid_amount}</td>\n                          <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">${fee.balance.toFixed(2)}</td>\n                          <td className=\"px-4 py-4 whitespace-nowrap\">\n                            <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                              fee.status === 'Paid' ? 'bg-green-100 text-green-800' :\n                              fee.status === 'Unpaid' ? 'bg-red-100 text-red-800' :\n                              'bg-yellow-100 text-yellow-800'\n                            }`}>\n                              {fee.status}\n                            </span>\n                          </td>\n                          <td className=\"px-4 py-4 whitespace-nowrap text-sm text-gray-900\">{fee.due_date}</td>\n                        </tr>\n                      );\n                    })}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FeeManagement;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}